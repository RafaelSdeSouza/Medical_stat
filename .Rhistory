for(i in 20){
TUBE_LENGTH[[i]] <- data.frame(preg$LEFT_TUBE_LENGTH,preg$RIGHT_TUBE_LENGTH)[i,1+rbinom(1,1,0.5)]
}
TUBE_LENGTH <- list()
for(i in 20){
TUBE_LENGTH[[i]] <- data.frame(preg$LEFT_TUBE_LENGTH,preg$RIGHT_TUBE_LENGTH)[i,1+rbinom(1,1,0.5)]
}
TUBE_LENGTH
TUBE_LENGTH <- list()
for(i in 20){
TUBE_LENGTH[i] <- data.frame(preg$LEFT_TUBE_LENGTH,preg$RIGHT_TUBE_LENGTH)[i,1+rbinom(1,1,0.5)]
}
TUBE_LENGTH
TUBE_LENGTH <- c()
for(i in 20){
TUBE_LENGTH <- append(TUBE_LENGTH,data.frame(preg$LEFT_TUBE_LENGTH,preg$RIGHT_TUBE_LENGTH)[i,1+rbinom(1,1,0.5)])
}
TUBE_LENGTH
TUBE_LENGTH <- c()
for(i in 20){
TUBE_LENGTH <- append(data.frame(preg$LEFT_TUBE_LENGTH,preg$RIGHT_TUBE_LENGTH)[i,1+rbinom(1,1,0.5)],TUBE_LENGTH,)
}
TUBE_LENGTH
TUBE_LENGTH
TUBE_LENGTH <- c()
for(i in 20){
TUBE_LENGTH <- append(data.frame(preg$LEFT_TUBE_LENGTH,preg$RIGHT_TUBE_LENGTH)[i,1+rbinom(1,1,0.5)],TUBE_LENGTH,)
}
TUBE_LENGTH <- data.frame(preg$LEFT_TUBE_LENGTH,preg$RIGHT_TUBE_LENGTH)
TUBE_LENGTH <- data.frame(preg$LEFT_TUBE_LENGTH,preg$RIGHT_TUBE_LENGTH)
for(i in 20){
TL <- append(TUBE_LENGTH[i,1+rbinom(1,1,0.5)],TL)
}
TUBE_LENGTH <- data.frame(preg$LEFT_TUBE_LENGTH,preg$RIGHT_TUBE_LENGTH)
TL <- c()
for(i in 20){
TL <- append(TUBE_LENGTH[i,1+rbinom(1,1,0.5)],TL)
}
TL
TUBE_LENGTH <- data.frame(preg$LEFT_TUBE_LENGTH,preg$RIGHT_TUBE_LENGTH)
TL <- c()
for(i in 20){
TL <- append(TL,TUBE_LENGTH[i,1+rbinom(1,1,0.5)])
}
TL
TUBE_LENGTH[i,1+rbinom(1,1,0.5)]
TUBE_LENGTH[i,1+rbinom(1,1,0.5)]
TUBE_LENGTH[i,1+rbinom(1,1,0.5)]
TUBE_LENGTH[i,1+rbinom(1,1,0.5)]
TUBE_LENGTH[i,1+rbinom(1,1,0.5)]
TUBE_LENGTH[i,1+rbinom(1,1,0.5)]
TUBE_LENGTH[i,1+rbinom(1,1,0.5)]
i
TUBE_LENGTH[i,1+rbinom(1,1,0.5)]
TUBE_LENGTH <- data.frame(preg$LEFT_TUBE_LENGTH,preg$RIGHT_TUBE_LENGTH)
TL <- c()
for(i in 1:5){
TL <- append(TL,TUBE_LENGTH[i,1+rbinom(1,1,0.5)])
}
TL
TUBE_LENGTH[1:5,]
TUBE_LENGTH <- data.frame(preg$LEFT_TUBE_LENGTH,preg$RIGHT_TUBE_LENGTH)
TL <- c()
for(i in 1:5){
TL <- append(TL,TUBE_LENGTH[i,1+rbinom(1,1,0.5)])
}
TUBE_LENGTH <- data.frame(preg$LEFT_TUBE_LENGTH,preg$RIGHT_TUBE_LENGTH)
TL <- c()
for(i in 1:5){
TL <- append(TL,TUBE_LENGTH[i,1+rbinom(1,1,0.5)])
}
TUBE_LENGTH <- data.frame(preg$LEFT_TUBE_LENGTH,preg$RIGHT_TUBE_LENGTH)
TL <- c()
for(i in 1:5){
TL <- append(TL,TUBE_LENGTH[i,1+rbinom(1,1,0.5)])
}
TUBE_LENGTH <- data.frame(preg$LEFT_TUBE_LENGTH,preg$RIGHT_TUBE_LENGTH)
TL <- c()
for(i in 1:5){
TL <- append(TL,TUBE_LENGTH[i,1+rbinom(1,1,0.5)])
}
TUBE_LENGTH <- data.frame(preg$LEFT_TUBE_LENGTH,preg$RIGHT_TUBE_LENGTH)
TL <- c()
for(i in 1:5){
TL <- append(TL,TUBE_LENGTH[i,1+rbinom(1,1,0.5)])
}
TUBE_LENGTH <- data.frame(preg$LEFT_TUBE_LENGTH,preg$RIGHT_TUBE_LENGTH)
TL <- c()
for(i in 1:5){
TL <- append(TL,TUBE_LENGTH[i,1+rbinom(1,1,0.5)])
}
TUBE_LENGTH <- data.frame(preg$LEFT_TUBE_LENGTH,preg$RIGHT_TUBE_LENGTH)
TL <- c()
for(i in 1:5){
TL <- append(TL,TUBE_LENGTH[i,1+rbinom(1,1,0.5)])
}
TUBE_LENGTH <- data.frame(preg$LEFT_TUBE_LENGTH,preg$RIGHT_TUBE_LENGTH)
TL <- c()
for(i in 1:5){
TL <- append(TL,TUBE_LENGTH[i,1+rbinom(1,1,0.5)])
}
TUBE_LENGTH <- data.frame(preg$LEFT_TUBE_LENGTH,preg$RIGHT_TUBE_LENGTH)
TL <- c()
for(i in 1:5){
TL <- append(TL,TUBE_LENGTH[i,1+rbinom(1,1,0.5)])
}
TUBE_LENGTH <- data.frame(preg$LEFT_TUBE_LENGTH,preg$RIGHT_TUBE_LENGTH)
TL <- c()
for(i in 1:5){
TL <- append(TL,TUBE_LENGTH[i,1+rbinom(1,1,0.5)])
}
TUBE_LENGTH <- data.frame(preg$LEFT_TUBE_LENGTH,preg$RIGHT_TUBE_LENGTH)
TL <- c()
for(i in 1:5){
TL <- append(TL,TUBE_LENGTH[i,1+rbinom(1,1,0.5)])
}
TUBE_LENGTH <- data.frame(preg$LEFT_TUBE_LENGTH,preg$RIGHT_TUBE_LENGTH)
TL <- c()
for(i in 1:5){
TL <- append(TL,TUBE_LENGTH[i,1+rbinom(1,1,0.5)])
}
TL
=======
fr(dfs[1,])
fr(dfs[1:3,])
fr(dfs[1:3,])
fr(dfs[1:3,])
fr(dfs[,])
fr(dfs)
crand(df)
crand <- function(x){
xr <- x[,1+rbinom(1,1,0.5)]
return(xr)
}
crand(df)
df <- preg  %>% select(c("LEFT_TUBE_LENGTH", "RIGHT_TUBE_LENGTH")) %>%
mutate(TL_rand = crand(df))
df
df <- preg  %>% select(c("LEFT_TUBE_LENGTH", "RIGHT_TUBE_LENGTH")) %>%
mutate(TL_rand = crand(df[,]))
df
crand(df[1:10,])
apply(dfs,1,crand)
apply(dfs[1,],1,crand)
dfs
dfs[,1+rbinom(1,1,0.5)]
dfs[1,1+rbinom(1,1,0.5)]
dfs[1,1+rbinom(1,1,0.5)]
dfs[1,1+rbinom(1,1,0.5)]
dfs[1,1+rbinom(1,1,0.5)]
dfs[1,1+rbinom(1,1,0.5)]
dfs[1,1+rbinom(1,1,0.5)]
dfs[1,1+rbinom(1,1,0.5)]
crand <- function(x){
xr <- x[1+rbinom(1,1,0.5)]
return(xr)
}
apply(dfs,1,crand)
df <- preg  %>% select(c("LEFT_TUBE_LENGTH", "RIGHT_TUBE_LENGTH")) %>%
mutate(TL_rand = apply(df,1,crand))
df
df$TL_rand == df$LEFT_TUBE_LENGTH
table(df$TL_rand == df$LEFT_TUBE_LENGTH)
df <- preg  %>% select(c("LEFT_TUBE_LENGTH", "RIGHT_TUBE_LENGTH")) %>%
mutate(TL_rand = apply(df,1,crand))
table(df$TL_rand == df$LEFT_TUBE_LENGTH)
df <- preg  %>% select(c("LEFT_TUBE_LENGTH", "RIGHT_TUBE_LENGTH")) %>%
mutate(TL_rand = apply(df,1,crand))
table(df$TL_rand == df$LEFT_TUBE_LENGTH)
df <- preg  %>% select(c("LEFT_TUBE_LENGTH", "RIGHT_TUBE_LENGTH")) %>%
mutate(TL_rand = apply(df,1,crand))
table(df$TL_rand == df$LEFT_TUBE_LENGTH)
df <- preg  %>% select(c("LEFT_TUBE_LENGTH", "RIGHT_TUBE_LENGTH")) %>%
mutate(TL_rand = apply(df,1,crand))
table(df$TL_rand == df$LEFT_TUBE_LENGTH)
df <- preg  %>% select(c("LEFT_TUBE_LENGTH", "RIGHT_TUBE_LENGTH")) %>%
mutate(TL_rand = apply(df,1,crand))
table(df$TL_rand == df$LEFT_TUBE_LENGTH)
df <- preg  %>% select(c("LEFT_TUBE_LENGTH", "RIGHT_TUBE_LENGTH")) %>%
mutate(TL_rand = apply(df,1,crand))
table(df$TL_rand == df$LEFT_TUBE_LENGTH)
df <- preg  %>% select(c("LEFT_TUBE_LENGTH", "RIGHT_TUBE_LENGTH")) %>%
mutate(TL_rand = apply(df,1,crand))
table(df$TL_rand == df$LEFT_TUBE_LENGTH)
df <- preg  %>% select(c("LEFT_TUBE_LENGTH", "RIGHT_TUBE_LENGTH")) %>%
mutate(TL_rand = apply(df,1,crand))
table(df$TL_rand == df$LEFT_TUBE_LENGTH)
df <- preg  %>% select(c("LEFT_TUBE_LENGTH", "RIGHT_TUBE_LENGTH")) %>%
mutate(TL_rand = apply(df,1,crand))
table(df$TL_rand == df$LEFT_TUBE_LENGTH)
df <- preg  %>% select(c("LEFT_TUBE_LENGTH", "RIGHT_TUBE_LENGTH")) %>%
mutate(TL_rand = apply(df,1,crand))
table(df$TL_rand == df$LEFT_TUBE_LENGTH)
df <- preg  %>% select(c("LEFT_TUBE_LENGTH", "RIGHT_TUBE_LENGTH")) %>%
mutate(TL_rand = apply(df,1,crand))
table(df$TL_rand == df$LEFT_TUBE_LENGTH)
df <- preg  %>% select(c("LEFT_TUBE_LENGTH", "RIGHT_TUBE_LENGTH")) %>%
mutate(TL_rand = apply(df,1,crand))
table(df$TL_rand == df$LEFT_TUBE_LENGTH)
df <- preg  %>% select(c("LEFT_TUBE_LENGTH", "RIGHT_TUBE_LENGTH")) %>%
mutate(TL_rand = apply(df,1,crand))
table(df$TL_rand == df$LEFT_TUBE_LENGTH)
df <- preg  %>% select(c("LEFT_TUBE_LENGTH", "RIGHT_TUBE_LENGTH")) %>%
mutate(TL_rand = apply(df,1,crand))
table(df$TL_rand == df$LEFT_TUBE_LENGTH)
rbinom(1,1,0.5)
rbinom(1,1,0.5)
rbinom(100,1,0.5)
table(rbinom(100,1,0.5))
table(rbinom(100,1,0.5))
table(rbinom(100,1,0.5))
table(rbinom(100,1,0.5))
table(rbinom(100,1,0.5)+1)
table(rbinom(100,1,0.5)+1)
table(rbinom(100,1,0.5)+1)
table(rbinom(100,1,0.5)+1)
table(rbinom(100,1,0.5)+1)
table(rbinom(100,1,0.5)+1)
table(rbinom(100,1,0.5)+1)
preg <- read.csv("BTA-Patients-MAW.csv") %>% select(c("BECOME_PREGNANT",      "TUBELENGTH_R_DISTAL",
"PREGNANT_NUMERIC",     "LIGATION_GROUP",
"TUBELENGTH_L_DISTAL",  "AGE",
"LEFT_TUBE_LENGTH",     "RIGHT_TUBE_LENGTH",
"TUBELENGTH_L_PROX",    "TUBELENGTH_R_PROX",
"L_DIAMETER_NUMERIC",   "R_DIAMETER_NUMERIC",
"L_FIBROSIS_NUMERIC",   "R_FIBROSIS_NUMERIC",
"ANASTOMOSIS2_NUMERIC","ANASTOMOSIS1_NUMERIC"
)) %>%
filter(AGE != "Yes") %>%  mutate(AGE = as.numeric(as.character(AGE)) )  %>%
filter(AGE > 10) %>%
na.omit() %>% mutate(LEFT_TUBE_LENGTH = as.numeric(as.character(LEFT_TUBE_LENGTH)) ) %>%
filter(BECOME_PREGNANT %in% c("Yes","No")) %>% droplevels()  %>%
mutate(TL_rand = apply(preg[,c("LEFT_TUBE_LENGTH","RIGHT_TUBE_LENGTH")],1,crand))
head(pref)
head(preg)
require(corplot)
require(corrplot)
install.packages("corrplot")
M<- preg[1:10,]
M
M[,1+rbinom(10,1,0.5)]
M <- preg[1:10,c("LEFT_TUBE_LENGTH","RIGHT_TUBE_LENGTH")]
M[,1+rbinom(10,1,0.5)]
preg[1:10,c("LEFT_TUBE_LENGTH","RIGHT_TUBE_LENGTH")]
M <- preg[1:10,c("LEFT_TUBE_LENGTH","RIGHT_TUBE_LENGTH")]
M[,1+rbinom(10,1,0.5)]
M
M[1:10,1+rbinom(10,1,0.5)]
1+rbinom(10,1,0.5)
crand <- function(x,seed){
if (!missing(seed))
set.seed(seed)
xr <- x[1+rbinom(1,1,0.5)]
return(xr)
}
preg <- read.csv("BTA-Patients-MAW.csv") %>% select(c("BECOME_PREGNANT",  "AGE",
"PREGNANT_NUMERIC",     "LIGATION_GROUP",
"TUBELENGTH_L_DISTAL",  "TUBELENGTH_R_DISTAL",
"LEFT_TUBE_LENGTH",     "RIGHT_TUBE_LENGTH",
"TUBELENGTH_L_PROX",    "TUBELENGTH_R_PROX",
"L_DIAMETER_NUMERIC",   "R_DIAMETER_NUMERIC",
"L_FIBROSIS_NUMERIC",   "R_FIBROSIS_NUMERIC",
"ANASTOMOSIS2_NUMERIC","ANASTOMOSIS1_NUMERIC"
)) %>%
filter(AGE != "Yes") %>%  mutate(AGE = as.numeric(as.character(AGE)) )  %>%
filter(AGE > 10) %>%
na.omit() %>% mutate(LEFT_TUBE_LENGTH = as.numeric(as.character(LEFT_TUBE_LENGTH)) ) %>%
filter(BECOME_PREGNANT %in% c("Yes","No")) %>% droplevels()  %>%
mutate(TL_rand = apply(preg[,c("LEFT_TUBE_LENGTH","RIGHT_TUBE_LENGTH")],1,crand,seed=42)) %>%
mutate(TLD_rand = apply(preg[,c( "TUBELENGTH_L_DISTAL",  "TUBELENGTH_R_DISTAL")],1,crand,seed=42)) %>%
mutate(TLP_rand = apply(preg[,c("TUBELENGTH_L_PROX", "TUBELENGTH_R_PROX")],1,crand,seed=42)) %>%
mutate(ANAS_rand = apply(preg[,c("ANASTOMOSIS2_NUMERIC","ANASTOMOSIS1_NUMERIC")],1,crand,seed=42)) %>%
mutate(Fibr_rand = apply(preg[,c("L_FIBROSIS_NUMERIC", "R_FIBROSIS_NUMERIC")],1,crand,seed=42))
preg
head(preg)
>>>>>>> 8e4f02980a6738c372d7c86cb160540cb535eb68
setwd("~/Documents/GitHub/Medical_stat")
# Pregnancy data
require(dplyr)
require(magrittr)
require(mgcv)
require(visreg)
library(FactoMineR)
require(caret)
library("factoextra")
library(pROC)
require(PRROC)
library(lime)
require(reshape)
require(corrplot)
# Auxiliar function to randomly select a given column
preg[,c("LEFT_TUBE_LENGTH","RIGHT_TUBE_LENGTH")]
setwd("~/Documents/GitHub/Medical_stat")
preg <- read.csv("BTA-Patients-MAW.csv") %>% select(c("BECOME_PREGNANT",  "AGE",
"PREGNANT_NUMERIC",     "LIGATION_GROUP",
"TUBELENGTH_L_DISTAL",  "TUBELENGTH_R_DISTAL",
"LEFT_TUBE_LENGTH",     "RIGHT_TUBE_LENGTH",
"TUBELENGTH_L_PROX",    "TUBELENGTH_R_PROX",
"L_DIAMETER_NUMERIC",   "R_DIAMETER_NUMERIC",
"L_FIBROSIS_NUMERIC",   "R_FIBROSIS_NUMERIC",
"ANASTOMOSIS2_NUMERIC","ANASTOMOSIS1_NUMERIC"
)) %>%
filter(AGE != "Yes") %>%  mutate(AGE = as.numeric(as.character(AGE)) )  %>%
filter(AGE > 10) %>%
na.omit() %>% mutate(LEFT_TUBE_LENGTH = as.numeric(as.character(LEFT_TUBE_LENGTH)) ) %>%
filter(BECOME_PREGNANT %in% c("Yes","No")) %>% droplevels()
preg[,c("LEFT_TUBE_LENGTH","RIGHT_TUBE_LENGTH")]
t(preg[,c("LEFT_TUBE_LENGTH","RIGHT_TUBE_LENGTH")])
head(t(preg[,c("LEFT_TUBE_LENGTH","RIGHT_TUBE_LENGTH")])()
head(t(preg[,c("LEFT_TUBE_LENGTH","RIGHT_TUBE_LENGTH")]))
head(t(preg[,c("LEFT_TUBE_LENGTH","RIGHT_TUBE_LENGTH")]))
t(preg[,c("LEFT_TUBE_LENGTH","RIGHT_TUBE_LENGTH")])[,1:2]
t(preg[,c("LEFT_TUBE_LENGTH","RIGHT_TUBE_LENGTH")])[,1:10]
t(preg[,c("LEFT_TUBE_LENGTH","RIGHT_TUBE_LENGTH")])[1,1:10]
preg[,c("LEFT_TUBE_LENGTH","RIGHT_TUBE_LENGTH")]
B <- preg[,c("LEFT_TUBE_LENGTH","RIGHT_TUBE_LENGTH")]
bb <- c(1,2,2,2,1)
B <- preg[,c("LEFT_TUBE_LENGTH","RIGHT_TUBE_LENGTH")]
bb <- c(1,2,2,2,1)
t <- c()
for(i in 1:5){
t <- B[i,bb[i]]
}
t
B <- preg[,c("LEFT_TUBE_LENGTH","RIGHT_TUBE_LENGTH")]
bb <- c(1,2,2,2,1)
t <- c()
for(i in 1:5){
t <- append(t,B[i,bb[i]])
}
t
rbinom(row(preg),1,0.5)
table(rbinom(row(preg),1,0.5))
table(rbinom(nrow(preg),1,0.5))
table(rbinom(nrow(preg),1,0.5))
rlist <- rbinom(nrow(preg),1,0.5)+1
rbinom(25,1,0.5)
TL_rand <- c()
TLD_rand <- c()
for (i in 1:10){
TL_rand <- append(TL_rand,temp1[i,rlist[i]])
TLD_rand <- append(TLD_rand,temp2[i,rlist[i]])
}
temp1 <- preg[,c("LEFT_TUBE_LENGTH","RIGHT_TUBE_LENGTH")]
temp2 <- preg[,c( "TUBELENGTH_L_DISTAL",  "TUBELENGTH_R_DISTAL")]
temp3 <- preg[,c("TUBELENGTH_L_PROX", "TUBELENGTH_R_PROX")]
temp4 <- preg[,c("ANASTOMOSIS2_NUMERIC","ANASTOMOSIS1_NUMERIC")]
temp5 <- preg[,c("L_FIBROSIS_NUMERIC","R_FIBROSIS_NUMERIC")]
TL_rand <- c()
TLD_rand <- c()
for (i in 1:10){
TL_rand <- append(TL_rand,temp1[i,rlist[i]])
TLD_rand <- append(TLD_rand,temp2[i,rlist[i]])
}
cbind(TL_rand,TLD_rand)
pregp[1:10,]
preg[1:10,]
temp2
TL_rand <- c()
TLD_rand <- c()
for (i in 1:10){
TL_rand <-  append(TL_rand,temp1[i,rlist[i]])
TLD_rand <- append(TLD_rand,temp2[i,rlist[i]])
}
cbind(TL_rand,TLD_rand)
TLD_rand
temp2[i,rlist[i]]
rlist[i]]
rlist[i]
temp2
temp2[1]
temp2[,1]
TLD_rand
temp2[,1]
temp2[,2]
preg <- read.csv("BTA-Patients-MAW.csv") %>% select(c("BECOME_PREGNANT",  "AGE",
"PREGNANT_NUMERIC",     "LIGATION_GROUP",
"TUBELENGTH_L_DISTAL",  "TUBELENGTH_R_DISTAL",
"LEFT_TUBE_LENGTH",     "RIGHT_TUBE_LENGTH",
"TUBELENGTH_L_PROX",    "TUBELENGTH_R_PROX",
"L_DIAMETER_NUMERIC",   "R_DIAMETER_NUMERIC",
"L_FIBROSIS_NUMERIC",   "R_FIBROSIS_NUMERIC",
"ANASTOMOSIS2_NUMERIC","ANASTOMOSIS1_NUMERIC"
)) %>%
filter(AGE != "Yes") %>%  mutate(AGE = as.numeric(as.character(AGE)) )  %>%
filter(AGE > 10) %>%
na.omit() %>% mutate(LEFT_TUBE_LENGTH = as.numeric(as.character(LEFT_TUBE_LENGTH)) ) %>%
mutate(TUBELENGTH_L_DISTAL = as.numeric(as.character(TUBELENGTH_L_DISTAL)) ) %>%
filter(BECOME_PREGNANT %in% c("Yes","No")) %>% droplevels()
rlist <- rbinom(nrow(preg),1,0.5) + 1
temp1 <- preg[,c("LEFT_TUBE_LENGTH","RIGHT_TUBE_LENGTH")]
temp2 <- preg[,c( "TUBELENGTH_L_DISTAL",  "TUBELENGTH_R_DISTAL")]
temp3 <- preg[,c("TUBELENGTH_L_PROX", "TUBELENGTH_R_PROX")]
temp4 <- preg[,c("ANASTOMOSIS2_NUMERIC","ANASTOMOSIS1_NUMERIC")]
temp5 <- preg[,c("L_FIBROSIS_NUMERIC","R_FIBROSIS_NUMERIC")]
TL_rand <- c()
TLD_rand <- c()
for (i in 1:10){
TL_rand <-  append(TL_rand,temp1[i,rlist[i]])
TLD_rand <- append(TLD_rand,temp2[i,rlist[i]])
}
cbind(TL_rand,TLD_rand)
head( preg)
TL_rand <- c()
TLD_rand <- c()
TLP_rand <- c()
ANAS_rand <- c()
Fibr_rand <- c()
for (i in 1:nrow(preg)){
TL_rand <-  append(TL_rand,temp1[i,rlist[i]])
TLD_rand <- append(TLD_rand,temp2[i,rlist[i]])
TLP_rand <- append(TLD_rand,temp3[i,rlist[i]])
ANAS_rand <- append(ANAS_rand,temp4[i,rlist[i]])
Fibr_rand <- append(Fibr_rand,temp5[i,rlist[i]])
}
preg <- preg %>%
mutate_(TL_rand = TL_rand) %>%
mutate_(TLD_rand = TLD_rand) %>%
mutate_(TLP_rand = TLP_rand) %>%
mutate_(ANAS_rand = ANAS_rand) %>%
mutate_(Fibr_rand = Fibr_rand)
nrow(preg)
Fibr_rand
ANAS_rand
TLP_rand
TLD_rand
TL_rand
preg
ANAS_rand
preg <- read.csv("BTA-Patients-MAW.csv") %>% select(c("BECOME_PREGNANT",  "AGE",
"PREGNANT_NUMERIC",     "LIGATION_GROUP",
"TUBELENGTH_L_DISTAL",  "TUBELENGTH_R_DISTAL",
"LEFT_TUBE_LENGTH",     "RIGHT_TUBE_LENGTH",
"TUBELENGTH_L_PROX",    "TUBELENGTH_R_PROX",
"L_DIAMETER_NUMERIC",   "R_DIAMETER_NUMERIC",
"L_FIBROSIS_NUMERIC",   "R_FIBROSIS_NUMERIC",
"ANASTOMOSIS2_NUMERIC","ANASTOMOSIS1_NUMERIC"
)) %>%
filter(AGE != "Yes") %>%  mutate(AGE = as.numeric(as.character(AGE)) )  %>%
filter(AGE > 10) %>%
na.omit() %>% mutate(LEFT_TUBE_LENGTH = as.numeric(as.character(LEFT_TUBE_LENGTH)) ) %>%
mutate(TUBELENGTH_L_DISTAL = as.numeric(as.character(TUBELENGTH_L_DISTAL)) ) %>%
filter(BECOME_PREGNANT %in% c("Yes","No")) %>% droplevels()
rlist <- rbinom(nrow(preg),1,0.5) + 1
temp1 <- preg[,c("LEFT_TUBE_LENGTH","RIGHT_TUBE_LENGTH")]
temp2 <- preg[,c( "TUBELENGTH_L_DISTAL",  "TUBELENGTH_R_DISTAL")]
temp3 <- preg[,c("TUBELENGTH_L_PROX", "TUBELENGTH_R_PROX")]
temp4 <- preg[,c("ANASTOMOSIS2_NUMERIC","ANASTOMOSIS1_NUMERIC")]
temp5 <- preg[,c("L_FIBROSIS_NUMERIC","R_FIBROSIS_NUMERIC")]
TL_rand <- c()
TLD_rand <- c()
TLP_rand <- c()
ANAS_rand <- c()
Fibr_rand <- c()
for (i in 1:nrow(preg)){
TL_rand <-  append(TL_rand,temp1[i,rlist[i]])
TLD_rand <- append(TLD_rand,temp2[i,rlist[i]])
TLP_rand <- append(TLD_rand,temp3[i,rlist[i]])
ANAS_rand <- append(ANAS_rand,temp4[i,rlist[i]])
Fibr_rand <- append(Fibr_rand,temp5[i,rlist[i]])
}
preg2 <- preg %>%
mutate(TL_rand = TL_rand) %>%
mutate(TLD_rand = TLD_rand) %>%
mutate(TLP_rand = TLP_rand) %>%
mutate(ANAS_rand = ANAS_rand) %>%
mutate(Fibr_rand = Fibr_rand)
TL_rand <- c()
TLD_rand <- c()
TLP_rand <- c()
ANAS_rand <- c()
Fibr_rand <- c()
for (i in 1:nrow(preg)){
TL_rand <-  append(TL_rand,temp1[i,rlist[i]])
TLD_rand <- append(TLD_rand,temp2[i,rlist[i]])
TLP_rand <- append(TLP_rand,temp3[i,rlist[i]])
ANAS_rand <- append(ANAS_rand,temp4[i,rlist[i]])
Fibr_rand <- append(Fibr_rand,temp5[i,rlist[i]])
}
preg2 <- preg %>%
mutate(TL_rand = TL_rand) %>%
mutate(TLD_rand = TLD_rand) %>%
mutate(TLP_rand = TLP_rand) %>%
mutate(ANAS_rand = ANAS_rand) %>%
mutate(Fibr_rand = Fibr_rand)
preg2
head(preg2)
M <- preg2[,c("TL_rand","TLD_rand","TLP_rand","ANAS_rand","Fibr_rand")]
corrplot(M, type = "upper", order = "hclust",
col = brewer.pal(n = 8, name = "PuOr"))
M
preg2[,c("TL_rand","TLD_rand","TLP_rand","ANAS_rand","Fibr_rand")]
M <- preg2[,c("TL_rand","TLD_rand","TLP_rand","ANAS_rand","Fibr_rand")]
M
corrplot(M, type = "upper", order = "hclust",
col = brewer.pal(n = 8, name = "PuOr"))
corrplot(M, type = "upper", order = "hclust")
cor(M)
corrplot(M)
corrplot(as.matrix(M))
as.matrix(M)
corrplot(M)
dim(M)
head(M)
mode(M)
mode(M[,1])
mode(M[,2])
mode(M[,3])
mode(M[,4])
mode(M[,5])
corrplot(cor(M))
corrplot(cor(M),method="number",type="lower")
