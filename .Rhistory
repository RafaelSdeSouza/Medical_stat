require(ggridges)
ggplot(tubesum,aes(x=value,y=LIGATION_GROUP)) +
geom_ridgeline()
ggplot(tubesum,aes(x=value,y=LIGATION_GROUP)) +
stat_density_ridges(geom = "density_ridges_gradient", calc_ecdf = TRUE,
quantiles = 5)
ggplot(tubesum,aes(x=value,y=LIGATION_GROUP)) +
stat_density_ridges(geom = "density")
ggplot(tubesum,aes(x=value,y=LIGATION_GROUP)) +
geom_density_ridges(stat = "binline", bins = 20, scale = 2.2)
ggplot(tubesum,aes(x=value,y=LIGATION_GROUP,
group=LIGATION_GROUP,fil=LIGATION_GROUP)) +
geom_density_ridges(stat = "binline", bins = 20, scale = 2.2)
tubesum
tubesum$value
as.numeric(tubesum$value)
tubesum <- preg %>%  select(c("LIGATION_GROUP","TUBELENGTH_R_DISTAL",
"TUBELENGTH_L_DISTAL",
"RIGHT_TUBE_LENGTH","LEFT_TUBE_LENGTH",
"TUBELENGTH_R_PROX","TUBELENGTH_L_PROX")) %>%
melt(.,id.vars="LIGATION_GROUP") %>%
mutate(value=as.numeric(value))
ggplot(tubesum,aes(x=value,y=LIGATION_GROUP,
group=LIGATION_GROUP,fil=LIGATION_GROUP)) +
geom_density_ridges(stat = "binline", bins = 20, scale = 2.2)
ggplot(tubesum,aes(x=value,y=LIGATION_GROUP,
group=variable,fil=variable)) +
geom_density_ridges(stat = "binline", bins = 20, scale = 2.2)
ggplot(tubesum,aes(x=value,y=LIGATION_GROUP,
group=variable,fil=variable)) +
geom_density_ridges(stat = "binline", bins = 20, scale = 2.2)
tubesum
tubesum
ggplot(tubesum,aes(x=value,y=LIGATION_GROUP,
fil=variable)) +
geom_density_ridges(stat = "binline", bins = 20, scale = 2.2)
ggplot(tubesum,aes(x=value,y=LIGATION_GROUP,
fill=variable)) +
geom_density_ridges(stat = "binline", bins = 20, scale = 2.2)
ggplot(tubesum,aes(x=value,group=variable,
fill=variable)) +
geom_density() +
facet_wrap(.~LIGATION_GROUP)
ggplot(tubesum,aes(x=value,group=variable,
fill=variable)) +
geom_histogram() +
facet_wrap(.~LIGATION_GROUP)
ggplot(tubesum,aes(x=value,group=variable,
fill=variable)) +
geom_histogram(bins = 5) +
facet_wrap(.~LIGATION_GROUP)
ggplot(tubesum,aes(x=value,group=variable,
fill=variable)) +
geom_histogram(bins = 10) +
facet_wrap(.~LIGATION_GROUP)
ggplot(tubesum,aes(x=value,group=variable,
fill=variable)) +
geom_histogram(bins = 10) +
facet_wrap(.~LIGATION_GROUP,scales = free_x)
ggplot(tubesum,aes(x=value,group=variable,
fill=variable)) +
geom_histogram(bins = 10) +
facet_wrap(.~LIGATION_GROUP,scales = "free_x")
ggplot(tubesum,aes(x=value,group=variable,
fill=variable)) +
geom_histogram(bins = 10) +
facet_wrap(.~LIGATION_GROUP,scales = "free_all")
ggplot(tubesum,aes(x=value,group=variable,
fill=variable)) +
geom_histogram(bins = 10) +
facet_wrap(.~LIGATION_GROUP,scales = "free")
ggplot(tubesum,aes(x=variable,y=value,group=variable,
fill=variable)) +
geom_boxplot() +
facet_wrap(.~LIGATION_GROUP,scales = "free")
ggplot(tubesum,aes(x=variable,y=value,group=variable,
fill=variable)) +
geom_boxplot() +
facet_wrap(.~LIGATION_GROUP,scales = "free") +
theme(legend.position = "none")
ggplot(tubesum,aes(x=variable,y=value,group=variable,
fill=variable)) +
geom_boxplot() +
facet_wrap(.~LIGATION_GROUP,scales = "free") +
theme(plot.background = element_rect(fill = "white"),
panel.background = element_rect(fill = "white",
colour = "white",
size = 0.5, linetype = "solid"),
text=element_text(family="serif"),
strip.text = element_text(size=22),
strip.background = element_rect(fill = "white"),
axis.title = element_text(size=25),
axis.text  = element_text(size=20),
axis.ticks = element_line(size = 0.45),
axis.text.x = element_text(hjust = 1),
legend.position = "none",
legend.background = element_rect(colour = "white", fill = "white"),
legend.text = element_text(size=25),
legend.text.align = 0,
legend.key = element_rect(colour = "white", fill = "white")) +
guides(size = guide_legend(override.aes = list(size = 4)))
ggplot(tubesum,aes(x=variable,y=value,group=variable,
fill=variable)) +
geom_boxplot(notch = T,outlier.shape = NA) +
facet_wrap(.~LIGATION_GROUP,scales = "free") +
theme(plot.background = element_rect(fill = "white"),
panel.background = element_rect(fill = "white",
colour = "white",
size = 0.5, linetype = "solid"),
text=element_text(family="serif"),
strip.text = element_text(size=22),
strip.background = element_rect(fill = "white"),
axis.title = element_text(size=25),
axis.text  = element_text(size=20),
axis.ticks = element_line(size = 0.45),
axis.text.x = element_text(hjust = 1),
legend.position = "none",
legend.background = element_rect(colour = "white", fill = "white"),
legend.text = element_text(size=25),
legend.text.align = 0,
legend.key = element_rect(colour = "white", fill = "white")) +
guides(size = guide_legend(override.aes = list(size = 4)))
ggplot(tubesum,aes(x=variable,y=value,group=variable,
fill=variable)) +
geom_boxplot(outlier.shape = NA) +
facet_wrap(.~LIGATION_GROUP,scales = "free") +
theme(plot.background = element_rect(fill = "white"),
panel.background = element_rect(fill = "white",
colour = "white",
size = 0.5, linetype = "solid"),
text=element_text(family="serif"),
strip.text = element_text(size=22),
strip.background = element_rect(fill = "white"),
axis.title = element_text(size=25),
axis.text  = element_text(size=20),
axis.ticks = element_line(size = 0.45),
axis.text.x = element_text(angle = 90,hjust = 1),
legend.position = "none",
legend.background = element_rect(colour = "white", fill = "white"),
legend.text = element_text(size=25),
legend.text.align = 0,
legend.key = element_rect(colour = "white", fill = "white")) +
guides(size = guide_legend(override.aes = list(size = 4)))
ggplot(tubesum,aes(x=variable,y=value,group=variable,
fill=variable)) +
geom_boxplot(outlier.shape = NA) +
facet_wrap(.~LIGATION_GROUP,scales = "free") +
theme(plot.background = element_rect(fill = "white"),
panel.background = element_rect(fill = "white",
colour = "white",
size = 0.5, linetype = "solid"),
text=element_text(family="serif"),
strip.text = element_text(size=22),
strip.background = element_rect(fill = "white"),
axis.title = element_text(size=25),
axis.text  = element_text(size=20),
axis.ticks = element_line(size = 0.45),
axis.text.x = element_text(angle = 90,hjust = 1),
legend.position = "none",
legend.background = element_rect(colour = "white", fill = "white"),
legend.text = element_text(size=25),
legend.text.align = 0,
legend.key = element_rect(colour = "white", fill = "white"))
ggplot(tubesum,aes(x=variable,y=value,group=variable,
fill=variable)) +
geom_boxplot(outlier.shape = NA) +
facet_wrap(.~LIGATION_GROUP,scales = "free") +
theme(plot.background = element_rect(fill = "white"),
panel.background = element_rect(fill = "white",
colour = "white",
size = 0.5, linetype = "solid"),
text=element_text(family="serif"),
strip.text = element_text(size=22),
strip.background = element_rect(fill = "white"),
axis.title = element_text(size=25),
axis.text  = element_text(size=5),
axis.ticks = element_line(size = 0.45),
axis.text.x = element_text(angle = 90,hjust = 1),
legend.position = "none",
legend.background = element_rect(colour = "white", fill = "white"),
legend.text = element_text(size=25),
legend.text.align = 0,
legend.key = element_rect(colour = "white", fill = "white"))
ggplot(tubesum,aes(x=variable,y=value,group=variable,
fill=variable)) +
geom_boxplot(outlier.shape = NA) +
facet_wrap(.~LIGATION_GROUP,scales = "free") +
theme(plot.background = element_rect(fill = "white"),
panel.background = element_rect(fill = "white",
colour = "white",
size = 0.5, linetype = "solid"),
text=element_text(family="serif"),
strip.text = element_text(size=22),
strip.background = element_rect(fill = "white"),
axis.title = element_text(size=25),
axis.text  = element_text(size=5),
axis.ticks = element_line(size = 0.45),
axis.text.x = element_text(angle = 45,hjust = 1),
legend.position = "none",
legend.background = element_rect(colour = "white", fill = "white"),
legend.text = element_text(size=25),
legend.text.align = 0,
legend.key = element_rect(colour = "white", fill = "white"))
ggplot(tubesum,aes(x=variable,y=value,group=variable,
fill=variable)) +
geom_boxplot(outlier.shape = NA) +
facet_wrap(.~LIGATION_GROUP,scales = "free") +
ylab("Lenght") + xlab("") +
theme(plot.background = element_rect(fill = "white"),
panel.background = element_rect(fill = "white",
colour = "white",
size = 0.5, linetype = "solid"),
text=element_text(family="serif"),
strip.text = element_text(size=22),
strip.background = element_rect(fill = "white"),
axis.title = element_text(size=25),
axis.text  = element_text(size=5),
axis.ticks = element_line(size = 0.45),
axis.text.x = element_text(angle = 45,hjust = 1),
legend.position = "none",
legend.background = element_rect(colour = "white", fill = "white"),
legend.text = element_text(size=25),
legend.text.align = 0,
legend.key = element_rect(colour = "white", fill = "white"))
ggplot(tubesum,aes(x=variable,y=value,group=variable,
fill=variable)) +
geom_boxplot(outlier.shape = NA) +
facet_wrap(.~LIGATION_GROUP,scales = "free") +
ylab("Lenght") + xlab("") +
theme(plot.background = element_rect(fill = "white"),
panel.background = element_rect(fill = "white",
colour = "white",
size = 0.5, linetype = "solid"),
text=element_text(family="serif"),
strip.text = element_text(size=22),
strip.background = element_rect(fill = "white"),
axis.title = element_text(size=15),
axis.text  = element_text(size=5),
axis.ticks = element_line(size = 0.45),
axis.text.x = element_text(angle = 45,hjust = 1),
legend.position = "none",
legend.background = element_rect(colour = "white", fill = "white"),
legend.text = element_text(size=25),
legend.text.align = 0,
legend.key = element_rect(colour = "white", fill = "white"))
ggplot(tubesum,aes(x=variable,y=value,group=variable,
fill=variable)) +
geom_boxplot(outlier.shape = NA) +
facet_wrap(.~LIGATION_GROUP,scales = "free") +
ylab("Lenght") + xlab("") +
theme(plot.background = element_rect(fill = "white"),
panel.background = element_rect(fill = "white",
colour = "white",
size = 0.5, linetype = "solid"),
text=element_text(family="serif"),
strip.text = element_text(size=10),
strip.background = element_rect(fill = "white"),
axis.title = element_text(size=10),
axis.text  = element_text(size=10),
axis.ticks = element_line(size = 0.45),
axis.text.x = element_text(angle = 45,hjust = 1),
legend.position = "none",
legend.background = element_rect(colour = "white", fill = "white"),
legend.text = element_text(size=25),
legend.text.align = 0,
legend.key = element_rect(colour = "white", fill = "white"))
ggplot(tubesum,aes(x=variable,y=value,group=variable,
fill=variable)) +
geom_boxplot(outlier.shape = NA) +
facet_wrap(.~LIGATION_GROUP,scales = "free") +
ylab("Lenght") + xlab("") +
theme(plot.background = element_rect(fill = "white"),
panel.background = element_rect(fill = "white",
colour = "white",
size = 0.5, linetype = "solid"),
text=element_text(family="serif"),
strip.text = element_text(size=10),
strip.background = element_rect(fill = "white"),
axis.title = element_text(size=10),
axis.text  = element_text(size=5),
axis.ticks = element_line(size = 0.45),
axis.text.x = element_text(angle = 45,hjust = 1),
legend.position = "none",
legend.background = element_rect(colour = "white", fill = "white"),
legend.text = element_text(size=25),
legend.text.align = 0,
legend.key = element_rect(colour = "white", fill = "white"))
ggplot(tubesum,aes(x=variable,y=value,group=variable,
fill=variable)) +
geom_boxplot(outlier.shape = NA) +
facet_wrap(.~LIGATION_GROUP) +
ylab("Lenght") + xlab("") +
theme(plot.background = element_rect(fill = "white"),
panel.background = element_rect(fill = "white",
colour = "white",
size = 0.5, linetype = "solid"),
text=element_text(family="serif"),
strip.text = element_text(size=10),
strip.background = element_rect(fill = "white"),
axis.title = element_text(size=10),
axis.text  = element_text(size=5),
axis.ticks = element_line(size = 0.45),
axis.text.x = element_text(angle = 45,hjust = 1),
legend.position = "none",
legend.background = element_rect(colour = "white", fill = "white"),
legend.text = element_text(size=25),
legend.text.align = 0,
legend.key = element_rect(colour = "white", fill = "white"))
ggplot(tubesum,aes(x=variable,y=value,group=variable,
fill=variable)) +
geom_boxplot(outlier.shape = NA) +
facet_wrap(.~LIGATION_GROUP) +
ylab("Lenght") + xlab("") +
theme(plot.background = element_rect(fill = "white"),
panel.background = element_rect(fill = "white",
colour = "white",
size = 0.5, linetype = "solid"),
text=element_text(family="serif"),
strip.text = element_text(size=10),
strip.background = element_rect(fill = "white"),
axis.title = element_text(size=10),
axis.text  = element_text(size=10),
axis.ticks = element_line(size = 0.45),
axis.text.x = element_text(angle = 45,hjust = 1),
legend.position = "none",
legend.background = element_rect(colour = "white", fill = "white"),
legend.text = element_text(size=25),
legend.text.align = 0,
legend.key = element_rect(colour = "white", fill = "white"))
ggplot(tubesum,aes(x=variable,y=value,group=variable,
fill=variable)) +
geom_boxplot(outlier.shape = NA) +
facet_wrap(.~LIGATION_GROUP) +
ylab("Lenght") + xlab("") +
theme(plot.background = element_rect(fill = "white"),
panel.background = element_rect(fill = "white",
colour = "white",
size = 0.5, linetype = "solid"),
text=element_text(family="serif"),
strip.text = element_text(size=10),
strip.background = element_rect(fill = "white"),
axis.title = element_text(size=10),
axis.text  = element_text(size=7),
axis.ticks = element_line(size = 0.45),
axis.text.x = element_text(angle = 45,hjust = 1),
legend.position = "none",
legend.background = element_rect(colour = "white", fill = "white"),
legend.text = element_text(size=25),
legend.text.align = 0,
legend.key = element_rect(colour = "white", fill = "white"))
ggplot(tubesum,aes(x=variable,y=value,group=variable,
fill=variable)) +
geom_boxplot(outlier.shape = NA) +
facet_wrap(.~LIGATION_GROUP) +
ylab("Lenght") + xlab("") +
theme(plot.background = element_rect(fill = "white"),
panel.background = element_rect(fill = "white",
colour = "white",
size = 0.5, linetype = "solid"),
text=element_text(family="serif"),
strip.text = element_text(size=10),
strip.background = element_rect(fill = "white"),
axis.title = element_text(size=10),
axis.text  = element_text(size=7),
axis.ticks = element_line(size = 0.45),
axis.text.x = element_text(angle = 45,hjust = 1),
legend.position = "none",
legend.background = element_rect(colour = "white", fill = "white"),
legend.text = element_text(size=25),
legend.text.align = 0,
legend.key = element_rect(colour = "white", fill = "white"))
ggplot(tubesum,aes(x=variable,y=value,group=variable,
fill=variable)) +
geom_boxplot(outlier.shape = NA) +
facet_wrap(.~LIGATION_GROUP) +
ylab("Lenght") + xlab("") +
theme(plot.background = element_rect(fill = "white"),
panel.background = element_rect(fill = "white",
colour = "white",
size = 0.5, linetype = "solid"),
text=element_text(family="serif"),
strip.text = element_text(size=10),
strip.background = element_rect(fill = "white"),
axis.title = element_text(size=10),
axis.text  = element_text(size=7),
axis.ticks = element_line(size = 0.45),
axis.text.x = element_text(angle = 60,hjust = 1),
legend.position = "none",
legend.background = element_rect(colour = "white", fill = "white"),
legend.text = element_text(size=25),
legend.text.align = 0,
legend.key = element_rect(colour = "white", fill = "white"))
preg <- read.csv("BTA-Patients-MAW.csv")
colnames(preg)
preg$ANASTOMOSIS
preg$ANASTOMOSIS1_GROUP
preg$ANASTOMOSIS2_GROUP
preg$ANASTOMOSIS1_NUMERIC
preg$L_DIAMETERS
preg$DIAMETER_TOTAL_NUMERIC
preg$R_DIAMETER_NUMERIC
preg <- read.csv("BTA-Patients-MAW.csv") %>% select(c("BECOME_PREGNANT","TUBELENGTH_R_DISTAL","PREGNANT_NUMERIC",
"TUBELENGTH_L_DISTAL","LIGATION_GROUP",
"AGE","RIGHT_TUBE_LENGTH","LEFT_TUBE_LENGTH",
"TUBELENGTH_R_PROX",
"TUBELENGTH_L_PROX","AV_TUBELENGTH_GP",
"R_DIAMETER_NUMERIC",
"L_DIAMETER_NUMERIC",
"R_FIBROSIS_NUMERIC",
"L_FIBROSIS_NUMERIC")) %>%
filter(AGE != "Yes") %>%  mutate(AGE = as.numeric(as.character(AGE)) )  %>%
filter(AGE > 10) %>%
na.omit() %>% mutate(LEFT_TUBE_LENGTH = as.numeric(as.character(LEFT_TUBE_LENGTH)) ) %>%
mutate(PCA_TUBE_LENGTH = -prcomp(data.frame(RIGHT_TUBE_LENGTH,LEFT_TUBE_LENGTH))$x[,1]) %>%
#  mutate(assymetry = (RIGHT_TUBE_LENGTH + LEFT_TUBE_LENGTH)/apply(data.frame(RIGHT_TUBE_LENGTH,LEFT_TUBE_LENGTH), 1, max)) %>%
mutate(assymetry = (RIGHT_TUBE_LENGTH + LEFT_TUBE_LENGTH)) %>%
filter(BECOME_PREGNANT %in% c("Yes","No")) %>% droplevels()
tubesum <- preg %>%  select(c("LIGATION_GROUP","TUBELENGTH_R_DISTAL",
"TUBELENGTH_L_DISTAL",
"RIGHT_TUBE_LENGTH","LEFT_TUBE_LENGTH",
"TUBELENGTH_R_PROX","TUBELENGTH_L_PROX",
"R_DIAMETER_NUMERIC",
"L_DIAMETER_NUMERIC",
"R_FIBROSIS_NUMERIC",
"L_FIBROSIS_NUMERIC"
)) %>%
melt(.,id.vars="LIGATION_GROUP") %>%
mutate(value=as.numeric(value))
ggplot(tubesum,aes(x=variable,y=value,group=variable,
fill=variable)) +
geom_boxplot(outlier.shape = NA) +
facet_wrap(.~LIGATION_GROUP) +
ylab("Lenght") + xlab("") +
theme(plot.background = element_rect(fill = "white"),
panel.background = element_rect(fill = "white",
colour = "white",
size = 0.5, linetype = "solid"),
text=element_text(family="serif"),
strip.text = element_text(size=10),
strip.background = element_rect(fill = "white"),
axis.title = element_text(size=10),
axis.text  = element_text(size=7),
axis.ticks = element_line(size = 0.45),
axis.text.x = element_text(angle = 60,hjust = 1),
legend.position = "none",
legend.background = element_rect(colour = "white", fill = "white"),
legend.text = element_text(size=25),
legend.text.align = 0,
legend.key = element_rect(colour = "white", fill = "white"))
trainIndex <- createDataPartition(preg$BECOME_PREGNANT, p = .5,
list = FALSE,
times = 1)
Train <- preg[trainIndex,]
Test  <- preg[-trainIndex,]
preg <- read.csv("BTA-Patients-MAW.csv") %>% select(c("BECOME_PREGNANT","TUBELENGTH_R_DISTAL","PREGNANT_NUMERIC",
"TUBELENGTH_L_DISTAL","LIGATION_GROUP",
"AGE","RIGHT_TUBE_LENGTH","LEFT_TUBE_LENGTH",
"TUBELENGTH_R_PROX",
"TUBELENGTH_L_PROX","AV_TUBELENGTH_GP",
"R_DIAMETER_NUMERIC",
"L_DIAMETER_NUMERIC",
"R_FIBROSIS_NUMERIC",
"L_FIBROSIS_NUMERIC")) %>%
filter(AGE != "Yes") %>%  mutate(AGE = as.numeric(as.character(AGE)) )  %>%
filter(AGE > 10) %>%
na.omit() %>% mutate(LEFT_TUBE_LENGTH = as.numeric(as.character(LEFT_TUBE_LENGTH)) ) %>%
mutate(PCA_TUBE_LENGTH = -prcomp(data.frame(RIGHT_TUBE_LENGTH,LEFT_TUBE_LENGTH))$x[,1]) %>%
#  mutate(assymetry = (RIGHT_TUBE_LENGTH + LEFT_TUBE_LENGTH)/apply(data.frame(RIGHT_TUBE_LENGTH,LEFT_TUBE_LENGTH), 1, max)) %>%
mutate(FTL = (RIGHT_TUBE_LENGTH + LEFT_TUBE_LENGTH)) %>%
mutate(DL = (R_DIAMETER_NUMERIC + R_FIBROSIS_NUMERIC)) %>%
mutate(FL = (L_FIBROSIS_NUMERIC + LEFT_TUBE_LENGTH)) %>%
filter(BECOME_PREGNANT %in% c("Yes","No")) %>% droplevels()
trainIndex <- createDataPartition(preg$BECOME_PREGNANT, p = .5,
list = FALSE,
times = 1)
Train <- preg[trainIndex,]
Test  <- preg[-trainIndex,]
fit0 <- gam(BECOME_PREGNANT~s(AGE,bs="cr",k=10)   + LIGATION_GROUP,data=preg,family = binomial(link="logit"))
preg <- read.csv("BTA-Patients-MAW.csv") %>% select(c("BECOME_PREGNANT","TUBELENGTH_R_DISTAL","PREGNANT_NUMERIC",
"TUBELENGTH_L_DISTAL","LIGATION_GROUP",
"AGE","RIGHT_TUBE_LENGTH","LEFT_TUBE_LENGTH",
"TUBELENGTH_R_PROX",
"TUBELENGTH_L_PROX","AV_TUBELENGTH_GP",
"R_DIAMETER_NUMERIC",
"L_DIAMETER_NUMERIC",
"R_FIBROSIS_NUMERIC",
"L_FIBROSIS_NUMERIC")) %>%
filter(AGE != "Yes") %>%  mutate(AGE = as.numeric(as.character(AGE)) )  %>%
filter(AGE > 10) %>%
na.omit() %>% mutate(LEFT_TUBE_LENGTH = as.numeric(as.character(LEFT_TUBE_LENGTH)) ) %>%
mutate(PCA_TUBE_LENGTH = -prcomp(data.frame(RIGHT_TUBE_LENGTH,LEFT_TUBE_LENGTH))$x[,1]) %>%
#  mutate(assymetry = (RIGHT_TUBE_LENGTH + LEFT_TUBE_LENGTH)/apply(data.frame(RIGHT_TUBE_LENGTH,LEFT_TUBE_LENGTH), 1, max)) %>%
mutate(TL = (RIGHT_TUBE_LENGTH + LEFT_TUBE_LENGTH)) %>%
mutate(DL = (R_DIAMETER_NUMERIC + R_FIBROSIS_NUMERIC)) %>%
mutate(FL = (L_FIBROSIS_NUMERIC + LEFT_TUBE_LENGTH)) %>%
filter(BECOME_PREGNANT %in% c("Yes","No")) %>% droplevels()
trainIndex <- createDataPartition(preg$BECOME_PREGNANT, p = .5,
list = FALSE,
times = 1)
Train <- preg[trainIndex,]
Test  <- preg[-trainIndex,]
# Case 0
fit0 <- gam(BECOME_PREGNANT~s(AGE,bs="cr",k=10)   + LIGATION_GROUP,data=preg,family = binomial(link="logit"))
fit <- gam(BECOME_PREGNANT~s(AGE,bs="cr",k=10)  + TL + DL + FL  + LIGATION_GROUP,data=preg,family= binomial(link="logit"))
visreg(fit,"assymetry",by="LIGATION_GROUP",cond = list(AGE = 25),
ylab = "Pregnancy probability", xlab="L + R",scale="response")
pred0 <- predict(fit0,newdata = Test[,-1],type="response")
pred1 <- predict(fit,newdata = Test[,-1],type="response")
plot(roc(Test$BECOME_PREGNANT, pred0, direction="<"),print.auc=TRUE,
lwd=3)
plot(roc(Test$BECOME_PREGNANT, pred1, direction="<"),print.auc=TRUE,
lwd=3)
