scale_fill_wsj(name = "") +
xlab("Segment position difference") +
ylab(" Per cent in each group") +
theme(legend.spacing.x = unit(0.15, 'cm'))
ggplot(PyrDiam, aes(x = variable, y =  100*(..count..)/sum(..count..), group = variable, fill = variable)) +   # Fill column
geom_boxplot()   +  my_style() +
scale_fill_wsj(name = "") +
xlab("Segment position difference") +
ylab(" Per cent in each group") +
theme(legend.spacing.x = unit(0.15, 'cm'))
ggplot(PyrDiam, aes(x = variable, group = variable, fill = variable)) +   # Fill column
geom_boxplot()   +  my_style() +
scale_fill_wsj(name = "") +
xlab("Segment position difference") +
ylab(" Per cent in each group") +
theme(legend.spacing.x = unit(0.15, 'cm'))
ggplot(PyrDiam, aes(x = variable, y=value,group = variable, fill = variable)) +   # Fill column
geom_boxplot()   +  my_style() +
scale_fill_wsj(name = "") +
xlab("Segment position difference") +
ylab(" Per cent in each group") +
theme(legend.spacing.x = unit(0.15, 'cm'))
ggplot(PyrDiam, aes(y = value,group = variable, fill = variable)) +   # Fill column
geom_boxplot()   +  my_style() +
scale_fill_wsj(name = "") +
xlab("Segment position difference") +
ylab(" Per cent in each group") +
theme(legend.spacing.x = unit(0.15, 'cm'))
PyrDiam
ggplot(PyrDiam, aes(y = as.factor(value),group = variable, fill = variable)) +   # Fill column
geom_boxplot()   +  my_style() +
scale_fill_wsj(name = "") +
xlab("Segment position difference") +
ylab(" Per cent in each group") +
theme(legend.spacing.x = unit(0.15, 'cm'))
PyrDiam <-  preg[,c("L_DIAMETER_NUMERIC","R_DIAMETER_NUMERIC")]  %>%
melt() %>%  mutate(variable = recode(variable, L_DIAMETER_NUMERIC = "Left diameter",
R_DIAMETER_NUMERIC = "Right diameter")) %>%
mutate(value=as.factor(value))
PyrDiam
ggplot(PyrDiam, aes(x = value,group = variable, fill = value)) +   # Fill column
geom_boxplot()
ggplot(PyrDiam, aes(y = value,group = variable, fill = value)) +   # Fill column
geom_boxplot()   +  my_style() +
scale_fill_wsj(name = "") +
xlab("Segment position difference") +
ylab(" Per cent in each group") +
theme(legend.spacing.x = unit(0.15, 'cm'))
PyrDiam <-  preg[,c("L_DIAMETER_NUMERIC","R_DIAMETER_NUMERIC")]  %>%
melt() %>%  mutate(variable = recode(variable, L_DIAMETER_NUMERIC = "Left diameter",
R_DIAMETER_NUMERIC = "Right diameter")) %>%
mutate(value=as.factor(value))
ggplot(PyrDiam, aes(y = value,group = variable, fill = value)) +   # Fill column
geom_boxplot()   +  my_style() +
scale_fill_wsj(name = "") +
xlab("Segment position difference") +
ylab(" Per cent in each group") +
theme(legend.spacing.x = unit(0.15, 'cm'))
ggplot(PyrDiam, aes(y = factor(value),group = variable, fill = value)) +   # Fill column
geom_boxplot()   +  my_style() +
scale_fill_wsj(name = "") +
xlab("Segment position difference") +
ylab(" Per cent in each group") +
theme(legend.spacing.x = unit(0.15, 'cm'))
PyrDiam$value
PyrDiam <-  preg[,c("L_DIAMETER_NUMERIC","R_DIAMETER_NUMERIC")]  %>%
melt() %>%  mutate(variable = recode(variable, L_DIAMETER_NUMERIC = "Left diameter",
R_DIAMETER_NUMERIC = "Right diameter")) %>%
mutate(value=as.factor(value))
ggplot(PyrDiam, aes(x = value,group = variable, fill = value)) +   # Fill column
geom_boxplot()   +  my_style() +
scale_fill_wsj(name = "") +
xlab("Segment position difference") +
ylab(" Per cent in each group") +
theme(legend.spacing.x = unit(0.15, 'cm'))
ggplot(PyrDiam, aes(x = value,y =  100*(..count..)/sum(..count..),group = variable, fill = value)) +   # Fill column
geom_boxplot()   +  my_style() +
scale_fill_wsj(name = "") +
xlab("Segment position difference") +
ylab(" Per cent in each group") +
theme(legend.spacing.x = unit(0.15, 'cm'))
ggplot(PyrDiam, aes(x = value,,group = variable, fill = value)) +   # Fill column
geom_boxplot(y =  100*(..count..)/sum(..count..))   +  my_style() +
scale_fill_wsj(name = "") +
xlab("Segment position difference") +
ylab(" Per cent in each group") +
theme(legend.spacing.x = unit(0.15, 'cm'))
ggplot(PyrDiam, aes(x = value,group = variable, fill = value)) +   # Fill column
geom_boxplot(aes(y =  100*(..count..)/sum(..count..)))   +  my_style() +
scale_fill_wsj(name = "") +
xlab("Segment position difference") +
ylab(" Per cent in each group") +
theme(legend.spacing.x = unit(0.15, 'cm'))
ggplot(PyrDiam, aes(x = value,group = variable, fill = value)) +   # Fill column
goem_histogram()
ggplot(PyrDiam, aes(x = value,group = variable, fill = value)) +   # Fill column
geom_histogram()
ggplot(PyrDiam, aes(x = value,group = variable, fill = value)) +   # Fill column
geom_histogram(stat="count")
ggplot(PyrDiam, aes(x = value,group = variable, fill = value)) +   # Fill column
geom_boxplot(stat="count")
ggplot(PyrDiam, aes(x = value,group = variable, fill = value)) +   # Fill column
geom_bar(stat="count")
ggplot(PyrDiam, aes(x = value,group = variable, fill = variable)) +   # Fill column
geom_bar(stat="count")
ggplot(PyrDiam, aes(x = value, y =  100*(..count..)/sum(..count..), fill = variable)) +   # Fill column
geom_bar()   +  my_style() +
scale_fill_wsj(name = "") +
xlab("Diameter") +
ylab(" Per cent in each group") +
theme(legend.spacing.x = unit(0.15, 'cm'))
preg <- read.csv("BTA-Patients-MAW.csv")
preg$R_DIAMETERS
preg$DIAMETER_TOTAL_NUMERIC
PyrDiam <-  preg[,c("L_DIAMETER_NUMERIC","R_DIAMETER_NUMERIC")]  %>%
melt() %>%  mutate(variable = recode(variable, L_DIAMETER_NUMERIC = "Left diameter",
R_DIAMETER_NUMERIC = "Right diameter")) %>%
mutate(value = recode(value,1= "Similar",
2 = "Somewhat dissimilar",
3 = "Dissimilar")) %>%
mutate(value=as.factor(value))
PyrDiam <-  preg[,c("L_DIAMETER_NUMERIC","R_DIAMETER_NUMERIC")]  %>%
melt() %>%  mutate(variable = recode(variable, L_DIAMETER_NUMERIC = "Left diameter",
R_DIAMETER_NUMERIC = "Right diameter")) %>%
mutate(value = recode(value, 1= "Similar",
2 = "Somewhat dissimilar",
3 = "Dissimilar"))
preg <- read.csv("BTA-Patients-MAW.csv") %>% select(c("PREGNANT_NUMERIC",  "AGE",
"LIGATION_GROUP",
"TUBELENGTH_L_DISTAL",  "TUBELENGTH_R_DISTAL",
"LEFT_TUBE_LENGTH",     "RIGHT_TUBE_LENGTH",
"TUBELENGTH_L_PROX",    "TUBELENGTH_R_PROX",
"L_DIAMETER_NUMERIC","R_DIAMETER_NUMERIC",
"L_DIAMETER_NUMERIC",   "R_DIAMETER_NUMERIC",
"L_FIBROSIS_NUMERIC",   "R_FIBROSIS_NUMERIC",
"ANASTOMOSIS2_NUMERIC","ANASTOMOSIS1_NUMERIC"
)) %>%
filter(AGE != "Yes") %>%  mutate(AGE = as.numeric(as.character(AGE)) )  %>%
filter(AGE > 10) %>%
na.omit() %>% mutate(LEFT_TUBE_LENGTH = as.numeric(as.character(LEFT_TUBE_LENGTH)) ) %>%
mutate(TUBELENGTH_L_DISTAL = as.numeric(as.character(TUBELENGTH_L_DISTAL)) ) %>%
filter(PREGNANT_NUMERIC %in% c(0,1)) %>%
mutate(PREGNANT_NUMERIC = as.numeric(as.character(PREGNANT_NUMERIC))) %>%
droplevels()
PyrDiam <-  preg[,c("L_DIAMETER_NUMERIC","R_DIAMETER_NUMERIC")]  %>%
melt() %>%  mutate(variable = recode(variable, L_DIAMETER_NUMERIC = "Left diameter",
R_DIAMETER_NUMERIC = "Right diameter")) %>%
mutate(value = recode(value, 1= "Similar",
2 = "Somewhat dissimilar",
3 = "Dissimilar")) %>%
mutate(value=as.factor(value))
preg[,c("L_DIAMETER_NUMERIC","R_DIAMETER_NUMERIC")]  %>%
melt()
preg[,c("L_DIAMETER_NUMERIC","R_DIAMETER_NUMERIC")]  %>%
melt() %>%  mutate(variable = recode(variable, L_DIAMETER_NUMERIC = "Left diameter",
R_DIAMETER_NUMERIC = "Right diameter"))
preg[,c("L_DIAMETER_NUMERIC","R_DIAMETER_NUMERIC")]  %>%
melt() %>%  mutate(variable = recode(variable, L_DIAMETER_NUMERIC = "Left diameter",
R_DIAMETER_NUMERIC = "Right diameter")) %>%
mutate(value = recode(value, 1 = "Similar",
2 = "Somewhat dissimilar",
3 = "Dissimilar"))
preg[,c("L_DIAMETER_NUMERIC","R_DIAMETER_NUMERIC")]  %>%
melt() %>%  mutate(variable = recode(variable, L_DIAMETER_NUMERIC = "Left diameter",
R_DIAMETER_NUMERIC = "Right diameter")) %>%
mutate(value = recode(value, "1" = "Similar",
"2" = "Somewhat dissimilar",
"3" = "Dissimilar")) %>%
mutate(value=as.factor(value))
PyrDiam <-  preg[,c("L_DIAMETER_NUMERIC","R_DIAMETER_NUMERIC")]  %>%
melt() %>%  mutate(variable = recode(variable, L_DIAMETER_NUMERIC = "Left diameter",
R_DIAMETER_NUMERIC = "Right diameter")) %>%
mutate(value = recode(value, "1" = "Similar",
"2" = "Somewhat dissimilar",
"3" = "Dissimilar")) %>%
mutate(value=as.factor(value))
ggplot(PyrDiam, aes(x = value, y =  100*(..count..)/sum(..count..), fill = variable)) +   # Fill column
geom_bar()   +  my_style() +
scale_fill_wsj(name = "") +
xlab("Diameter") +
ylab(" Per cent in each group") +
theme(legend.spacing.x = unit(0.15, 'cm'))
yrDiam <-  preg[,c("L_DIAMETER_NUMERIC","R_DIAMETER_NUMERIC")]  %>%
melt() %>%  mutate(variable = recode(variable, L_DIAMETER_NUMERIC = "Left diameter",
R_DIAMETER_NUMERIC = "Right diameter")) %>%
mutate(value = recode(value, "1" = "Similar",
"2" = "Somewhat dissimilar",
"3" = "Dissimilar")) %>%
mutate(value = factor(value,levels=c("Similar","Somewhat dissimilar","Dissimilar")))
ggplot(PyrDiam, aes(x = value, y =  100*(..count..)/sum(..count..), fill = variable)) +   # Fill column
geom_bar()   +  my_style() +
scale_fill_wsj(name = "") +
xlab("Diameter") +
ylab(" Per cent in each group") +
theme(legend.spacing.x = unit(0.15, 'cm'))
PyrDiam
PyrDiam$value
PyrDiam <-  preg[,c("L_DIAMETER_NUMERIC","R_DIAMETER_NUMERIC")]  %>%
melt() %>%  mutate(variable = recode(variable, L_DIAMETER_NUMERIC = "Left diameter",
R_DIAMETER_NUMERIC = "Right diameter")) %>%
mutate(value = recode(value, "1" = "Similar",
"2" = "Somewhat dissimilar",
"3" = "Dissimilar")) %>%
mutate(value = as.factor(value,levels=c("Similar","Somewhat dissimilar","Dissimilar")))
PyrDiam <-  preg[,c("L_DIAMETER_NUMERIC","R_DIAMETER_NUMERIC")]  %>%
melt() %>%  mutate(variable = recode(variable, L_DIAMETER_NUMERIC = "Left diameter",
R_DIAMETER_NUMERIC = "Right diameter")) %>%
mutate(value = recode(value, "1" = "Similar",
"2" = "Somewhat dissimilar",
"3" = "Dissimilar"))
levels(PyrDiam$value) <- c("Similar","Somewhat dissimilar","Dissimilar")
ggplot(PyrDiam, aes(x = value, y =  100*(..count..)/sum(..count..), fill = variable)) +   # Fill column
geom_bar()   +  my_style() +
scale_fill_wsj(name = "") +
xlab("Diameter") +
ylab(" Per cent in each group") +
theme(legend.spacing.x = unit(0.15, 'cm'))
PyrDiam$value
ggplot(PyrDiam, aes(x = value, y =  100*(..count..)/sum(..count..), fill = variable)) +   # Fill column
geom_bar()
ggplot(PyrDiam, aes(x = value, y =  100*(..count..)/sum(..count..), fill = variable)) +   # Fill column
geom_bar()   +  my_style() +
scale_fill_wsj(name = "") +
xlab("Diameter") +
ylab(" Per cent in each group") +
theme(legend.spacing.x = unit(0.15, 'cm'))
pdf("diameter.pdf",height = 5.5,width = 6.5)
ggplot(PyrDiam, aes(x = value, y =  100*(..count..)/sum(..count..), fill = variable)) +   # Fill column
geom_bar()   +  my_style() +
scale_fill_wsj(name = "") +
xlab("Diameter") +
ylab(" Per cent in each group") +
theme(legend.spacing.x = unit(0.15, 'cm'))
dev.off()
ggplot(PyrFib, aes(x = value, y =  100*(..count..)/sum(..count..), fill = variable)) +   # Fill column
geom_bar()   +  my_style() +
scale_fill_wsj(name = "") +
xlab("Fibrosis") +
ylab(" Per cent in each group") +
theme(legend.spacing.x = unit(0.15, 'cm'))
PyrFib <-  preg[,c("L_FIBROSIS_NUMERIC", "R_FIBROSIS_NUMERIC")]  %>%
melt() %>%  mutate(variable = recode(variable, L_FIBROSIS_NUMERIC = "Left tube",
R_FIBROSIS_NUMERIC = "Right tube")) %>%
mutate(value = recode(value, "0" = "None",
"1" = "Mild",
"2" = "Moderate",
"3" = "Severe"))
ggplot(PyrFib, aes(x = value, y =  100*(..count..)/sum(..count..), fill = variable)) +   # Fill column
geom_bar()   +  my_style() +
scale_fill_wsj(name = "") +
xlab("Fibrosis") +
ylab(" Per cent in each group") +
theme(legend.spacing.x = unit(0.15, 'cm'))
PyrFib <-  preg[,c("L_FIBROSIS_NUMERIC", "R_FIBROSIS_NUMERIC")]  %>%
melt() %>%  mutate(variable = recode(variable, L_FIBROSIS_NUMERIC = "Left tube",
R_FIBROSIS_NUMERIC = "Right tube")) %>%
mutate(value = recode(value, "0" = "None",
"1" = "Mild",
"2" = "Moderate",
"3" = "Severe"))  %>%
mutate(value = reorder( c("None",
"1" = "Mild",
"2" = "Moderate",
"3" = "Severe")) )
PyrFib <-  preg[,c("L_FIBROSIS_NUMERIC", "R_FIBROSIS_NUMERIC")]  %>%
melt() %>%  mutate(variable = recode(variable, L_FIBROSIS_NUMERIC = "Left tube",
R_FIBROSIS_NUMERIC = "Right tube")) %>%
mutate(value = recode(value, "0" = "None",
"1" = "Mild",
"2" = "Moderate",
"3" = "Severe"))  %>%
mutate(value = reorder(value, c("None",
"1" = "Mild",
"2" = "Moderate",
"3" = "Severe")) )
PyrFib <-  preg[,c("L_FIBROSIS_NUMERIC", "R_FIBROSIS_NUMERIC")]  %>%
melt() %>%  mutate(variable = recode(variable, L_FIBROSIS_NUMERIC = "Left tube",
R_FIBROSIS_NUMERIC = "Right tube")) %>%
mutate(value = recode(value, "0" = "None",
"1" = "Mild",
"2" = "Moderate",
"3" = "Severe"))  %>%
mutate(value = fct_reorder(value, c("None",
"1" = "Mild",
"2" = "Moderate",
"3" = "Severe")) )
require(purrr)
PyrFib <-  preg[,c("L_FIBROSIS_NUMERIC", "R_FIBROSIS_NUMERIC")]  %>%
melt() %>%  mutate(variable = recode(variable, L_FIBROSIS_NUMERIC = "Left tube",
R_FIBROSIS_NUMERIC = "Right tube")) %>%
mutate(value = recode(value, "0" = "None",
"1" = "Mild",
"2" = "Moderate",
"3" = "Severe"))  %>%
mutate(value = fct_reorder(value, c("None",
"1" = "Mild",
"2" = "Moderate",
"3" = "Severe")) )
require(forcats)
PyrFib <-  preg[,c("L_FIBROSIS_NUMERIC", "R_FIBROSIS_NUMERIC")]  %>%
melt() %>%  mutate(variable = recode(variable, L_FIBROSIS_NUMERIC = "Left tube",
R_FIBROSIS_NUMERIC = "Right tube")) %>%
mutate(value = recode(value, "0" = "None",
"1" = "Mild",
"2" = "Moderate",
"3" = "Severe"))  %>%
mutate(value = fct_reorder(value, c("None",
"1" = "Mild",
"2" = "Moderate",
"3" = "Severe")) )
PyrFib <-  preg[,c("L_FIBROSIS_NUMERIC", "R_FIBROSIS_NUMERIC")]  %>%
melt() %>%  mutate(variable = recode(variable, L_FIBROSIS_NUMERIC = "Left tube",
R_FIBROSIS_NUMERIC = "Right tube")) %>%
mutate(value = recode(value, "0" = "None",
"1" = "Mild",
"2" = "Moderate",
"3" = "Severe"))  %>%
mutate(value = fct_reorder(value, c("None","Mild", "Moderate","Severe")) )
preg[,c("L_FIBROSIS_NUMERIC", "R_FIBROSIS_NUMERIC")]  %>%
melt() %>%  mutate(variable = recode(variable, L_FIBROSIS_NUMERIC = "Left tube",
R_FIBROSIS_NUMERIC = "Right tube")) %>%
mutate(value = recode(value, "0" = "None",
"1" = "Mild",
"2" = "Moderate",
"3" = "Severe"))
preg[,c("L_FIBROSIS_NUMERIC", "R_FIBROSIS_NUMERIC")]  %>%
melt() %>%  mutate(variable = recode(variable, L_FIBROSIS_NUMERIC = "Left tube",
R_FIBROSIS_NUMERIC = "Right tube")) %>%
mutate(value = recode(value, "0" = "None",
"1" = "Mild",
"2" = "Moderate",
"3" = "Severe"))  %>%
mutate(value = fct_reorder(value, c("None","Mild", "Moderate","Severe")) )
preg[,c("L_FIBROSIS_NUMERIC", "R_FIBROSIS_NUMERIC")]  %>%
melt() %>%  mutate(variable = recode(variable, L_FIBROSIS_NUMERIC = "Left tube",
R_FIBROSIS_NUMERIC = "Right tube")) %>%
mutate(value = recode(value, "0" = "None",
"1" = "Mild",
"2" = "Moderate",
"3" = "Severe"))  %>%
fct_reorder(value, c("None","Mild", "Moderate","Severe"))
preg[,c("L_FIBROSIS_NUMERIC", "R_FIBROSIS_NUMERIC")]  %>%
melt() %>%  mutate(variable = recode(variable, L_FIBROSIS_NUMERIC = "Left tube",
R_FIBROSIS_NUMERIC = "Right tube")) %>%
mutate(value = recode(value, "0" = "None",
"1" = "Mild",
"2" = "Moderate",
"3" = "Severe"))  %>%
mutate(value = fct_reorder(value, c("None","Mild", "Moderate","Severe")) )
PyrFib <-  preg[,c("L_FIBROSIS_NUMERIC", "R_FIBROSIS_NUMERIC")]  %>%
melt() %>%  mutate(variable = recode(variable, L_FIBROSIS_NUMERIC = "Left tube",
R_FIBROSIS_NUMERIC = "Right tube")) %>%
mutate(value = recode(value, "0" = "None",
"1" = "Mild",
"2" = "Moderate",
"3" = "Severe"))
PyrFib$value
preg[,c("L_FIBROSIS_NUMERIC", "R_FIBROSIS_NUMERIC")]  %>%
melt() %>%  mutate(variable = recode(variable, L_FIBROSIS_NUMERIC = "Left tube",
R_FIBROSIS_NUMERIC = "Right tube")) %>%
mutate(value = recode(value, "0" = "None",
"1" = "Mild",
"2" = "Moderate",
"3" = "Severe"))  %>%
mutate(value = as.factor(value)) %>%
mutate(value = fct_reorder(value, c("None","Mild", "Moderate","Severe")) )
PyrFib <-  preg[,c("L_FIBROSIS_NUMERIC", "R_FIBROSIS_NUMERIC")]  %>%
melt() %>%  mutate(variable = recode(variable, L_FIBROSIS_NUMERIC = "Left tube",
R_FIBROSIS_NUMERIC = "Right tube")) %>%
mutate(value = recode(value, "0" = "None",
"1" = "Mild",
"2" = "Moderate",
"3" = "Severe"))  %>%
mutate(value = as.factor(value))
PyrFib$value
preg[,c("L_FIBROSIS_NUMERIC", "R_FIBROSIS_NUMERIC")]  %>%
melt() %>%  mutate(variable = recode(variable, L_FIBROSIS_NUMERIC = "Left tube",
R_FIBROSIS_NUMERIC = "Right tube")) %>%
mutate(value = recode(value, "0" = "None",
"1" = "Mild",
"2" = "Moderate",
"3" = "Severe"))  %>%
mutate(value = as.factor(value)) %>%
mutate(value = fct_reorder(value, c("None","Mild","Moderate","Severe")) )
preg[,c("L_FIBROSIS_NUMERIC", "R_FIBROSIS_NUMERIC")]  %>%
melt() %>%  mutate(variable = recode(variable, L_FIBROSIS_NUMERIC = "Left tube",
R_FIBROSIS_NUMERIC = "Right tube")) %>%
mutate(value = recode(value, "0" = "None",
"1" = "Mild",
"2" = "Moderate",
"3" = "Severe"))  %>%
mutate(value = as.factor(value)) %>%
mutate(value = reorder(value, c("None","Mild","Moderate","Severe")) )
preg[,c("L_FIBROSIS_NUMERIC", "R_FIBROSIS_NUMERIC")]  %>%
melt() %>%  mutate(variable = recode(variable, L_FIBROSIS_NUMERIC = "Left tube",
R_FIBROSIS_NUMERIC = "Right tube")) %>%
mutate(value = recode(value, "0" = "None",
"1" = "Mild",
"2" = "Moderate",
"3" = "Severe"))  %>%
mutate(value = as.factor(value)) %>%
mutate(value = reorder.factor(value, c("None","Mild","Moderate","Severe")) )
preg[,c("L_FIBROSIS_NUMERIC", "R_FIBROSIS_NUMERIC")]  %>%
melt() %>%  mutate(variable = recode(variable, L_FIBROSIS_NUMERIC = "Left tube",
R_FIBROSIS_NUMERIC = "Right tube")) %>%
mutate(value = recode(value, "0" = "None",
"1" = "Mild",
"2" = "Moderate",
"3" = "Severe"))  %>%
mutate(value = as.factor(value)) %>%
mutate(value = reorder(value, list=c("None","Mild","Moderate","Severe")) )
PyrFib <-  preg[,c("L_FIBROSIS_NUMERIC", "R_FIBROSIS_NUMERIC")]  %>%
melt() %>%  mutate(variable = recode(variable, L_FIBROSIS_NUMERIC = "Left tube",
R_FIBROSIS_NUMERIC = "Right tube")) %>%
mutate(value = recode(value, "0" = "None",
"1" = "Mild",
"2" = "Moderate",
"3" = "Severe"))  %>%
mutate(value = as.factor(value)) %>%
mutate(value = reorder(value, list=c("None","Mild","Moderate","Severe")) )
PyrFib$value
PyrFib <-  preg[,c("L_FIBROSIS_NUMERIC", "R_FIBROSIS_NUMERIC")]  %>%
melt() %>%  mutate(variable = recode(variable, L_FIBROSIS_NUMERIC = "Left tube",
R_FIBROSIS_NUMERIC = "Right tube")) %>%
mutate(value = recode(value, "0" = "None",
"1" = "Mild",
"2" = "Moderate",
"3" = "Severe"))  %>%
mutate(value = factor(value,levels=c("None","Mild","Moderate","Severe")))
PyrFib$value
PyrFib <-  preg[,c("L_FIBROSIS_NUMERIC", "R_FIBROSIS_NUMERIC")]  %>%
melt() %>%  mutate(variable = recode(variable, L_FIBROSIS_NUMERIC = "Left tube",
R_FIBROSIS_NUMERIC = "Right tube")) %>%
mutate(value = recode(value, "0" = "None",
"1" = "Mild",
"2" = "Moderate",
"3" = "Severe"))  %>%
mutate(value = factor(value,levels=c("None","Mild","Moderate","Severe")))
ggplot(PyrFib, aes(x = value, y =  100*(..count..)/sum(..count..), fill = variable)) +   # Fill column
geom_bar()   +  my_style() +
scale_fill_wsj(name = "") +
xlab("Fibrosis") +
ylab(" Per cent in each group") +
theme(legend.spacing.x = unit(0.15, 'cm'))
pdf("fibrosis.pdf",height = 5.5,width = 6.5)
ggplot(PyrFib, aes(x = value, y =  100*(..count..)/sum(..count..), fill = variable)) +   # Fill column
geom_bar()   +  my_style() +
scale_fill_wsj(name = "") +
xlab("Fibrosis") +
ylab(" Per cent in each group") +
theme(legend.spacing.x = unit(0.15, 'cm'))
dev.off()
PyrDiam <-  preg[,c("L_DIAMETER_NUMERIC","R_DIAMETER_NUMERIC")]  %>%
melt() %>%  mutate(variable = recode(variable, L_DIAMETER_NUMERIC = "Left diameter",
R_DIAMETER_NUMERIC = "Right diameter")) %>%
mutate(value = recode(value, "1" = "Similar",
"2" = "Somewhat dissimilar",
"3" = "Dissimilar")) %>%
mutate(value = factor(value,levels=c("Similar","Somewhat dissimilar","Dissimilar")))
ggplot(PyrDiam, aes(x = value, y =  100*(..count..)/sum(..count..), fill = variable)) +   # Fill column
geom_bar()   +  my_style() +
scale_fill_wsj(name = "") +
xlab("Diameter") +
ylab(" Per cent in each group") +
theme(legend.spacing.x = unit(0.15, 'cm'))
pdf("diameter.pdf",height = 5.5,width = 6.5)
ggplot(PyrDiam, aes(x = value, y =  100*(..count..)/sum(..count..), fill = variable)) +   # Fill column
geom_bar()   +  my_style() +
scale_fill_wsj(name = "") +
xlab("Diameter") +
ylab(" Per cent in each group") +
theme(legend.spacing.x = unit(0.15, 'cm'))
dev.off()
ggplot(PyrAN, aes(x = value, y =  100*(..count..)/sum(..count..), fill = variable)) +   # Fill column
geom_bar()   +  my_style() +
scale_fill_wsj(name = "") +
xlab("Anastomosis segment position difference") +
ylab(" Per cent in each group") +
theme(legend.spacing.x = unit(0.15, 'cm'))
pdf("Anastomosis.pdf",height = 5.5,width = 6.5)
ggplot(PyrAN, aes(x = value, y =  100*(..count..)/sum(..count..), fill = variable)) +   # Fill column
geom_bar()   +  my_style() +
scale_fill_wsj(name = "") +
xlab("Anastomosis segment position difference") +
ylab(" Per cent in each group") +
theme(legend.spacing.x = unit(0.15, 'cm'))
dev.off()
PyrAN
PyrAN %>% mutate(class = "Anastomosis")
PyrDiam %>% mutate(class = "Diameter")
PyrFib %>% mutate(class = "Fibrosis")
Py_all <- rbind(PyrAN,PyrDiam,PyrFib)
ggplot(Py_all, aes(x = value, y =  100*(..count..)/sum(..count..), fill = variable)) +   # Fill column
geom_bar()   +  my_style() +
scale_fill_wsj(name = "") +
xlab("Fibrosis") +
ylab(" Per cent in each group") +
theme(legend.spacing.x = unit(0.15, 'cm')) +
facet_wrap(.~class)
Py_all
PyrAN
PyrAN <- PyrAN %>% mutate(class = "Anastomosis")
PyrDiam <- PyrDiam  %>% mutate(class = "Diameter")
PyrFib <- PyrFib  %>% mutate(class = "Fibrosis")
Py_all <- rbind(PyrAN,PyrDiam,PyrFib)
ggplot(Py_all, aes(x = value, y =  100*(..count..)/sum(..count..), fill = variable)) +   # Fill column
geom_bar()   +  my_style() +
scale_fill_wsj(name = "") +
xlab("Fibrosis") +
ylab(" Per cent in each group") +
theme(legend.spacing.x = unit(0.15, 'cm')) +
facet_wrap(.~class)
